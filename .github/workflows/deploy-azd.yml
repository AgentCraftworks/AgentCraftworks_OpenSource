jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Initialize or select azd environment
        run: |
          azd env select cae-agentcraftworks-ce || azd env new cae-agentcraftworks-ce --subscription ${{ secrets.AZURE_SUBSCRIPTION_ID }} --location ${{ secrets.AZURE_LOCATION }}
      # other steps remain unchanged

  smoke-tests:
    needs: deploy
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Initialize or select azd environment
        run: |
          azd env select cae-agentcraftworks-ce || azd env new cae-agentcraftworks-ce --subscription ${{ secrets.AZURE_SUBSCRIPTION_ID }} --location ${{ secrets.AZURE_LOCATION }}
      # other steps remain unchanged
